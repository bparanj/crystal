## Property Based Testing

There is a Ruby equivalent to the Hypothesis library from Python, known as "Rantly". Rantly is a Ruby gem that allows property-based testing, similar to what Hypothesis offers for Python. Property-based testing is a technique where you specify the general properties of the output that a function should produce, and the testing library then generates test cases that try to falsify these properties.

### Features of Rantly:

- **Data Generation**: Like Hypothesis, Rantly can generate structured random data, such as integers, strings, arrays, hashes, etc., based on specifications you provide.
- **Property-based Testing**: It runs your test with many random inputs and checks the properties you expect.
- **Shrinking**: Although not as advanced as Hypothesis's shrinking capability, Rantly attempts to reduce failing test cases to simpler forms to help diagnose issues.

### How to Use Rantly:

1. **Install Rantly**:
   First, add Rantly to your Gemfile:
   ```ruby
   gem 'rantly'
   ```
   Then run `bundle install`.

2. **Write a Test**:
   Here's a basic example of using Rantly in a test (assuming you're using a testing framework like RSpec):
   ```ruby
   require 'rantly'
   require 'rantly/rspec_extensions'

   describe 'my test' do
     it 'should test property' do
       property_of {
         # Generate your test data
         Rantly { int }
       }.check { |i|
         # Your test logic
         expect(i).to be_a(Integer)
       }
     end
   end
   ```

In this test, `Rantly` is used to generate random integers, and the test checks that each generated value is an integer.

### Limitations:

- **Popularity and Support**: Rantly is not as widely known or as actively maintained as Hypothesis in Python.
- **Feature Set**: The feature set of Rantly might not be as extensive as Hypothesis, particularly in areas like test case shrinking.

In summary, while Rantly provides a way to perform property-based testing in Ruby, it may not be as feature-rich as Hypothesis. It's a good starting point for introducing property-based testing concepts into your Ruby tests.

## PBT and Rails

```
# frozen_string_literal: true

require "bundler/inline"

gemfile(true) do
  source "https://rubygems.org"

  git_source(:github) { |repo| "https://github.com/#{repo}.git" }

  gem 'activerecord'
  gem 'sqlite3'
  gem 'rantly'
  gem 'test-unit'
end

require 'active_record'
require 'test/unit'
require 'rantly/testunit_extensions' # for 'test/unit'
require 'rantly'


ActiveRecord::Base.establish_connection(adapter: 'sqlite3', database: ':memory:')
ActiveRecord::Schema.define do
  create_table :users do |t|
    t.string :name
  end
end

class User < ActiveRecord::Base
end

class FindSoleByTest < Test::Unit::TestCase
  def test_find_sole_by_with_unique_names
    100.times do
      name1, name2 = Rantly { [string, string] }
      next if name1 == name2

      User.create!(name: name1)
      User.create!(name: name2)

      assert_nothing_raised do
        User.find_sole_by(name: name1)
      end

      User.delete_all
    end
  end

  def test_find_sole_by_with_duplicate_names
    100.times do
      name = Rantly { string }
      2.times { User.create!(name: name) }

      assert_raise(ActiveRecord::SoleRecordExceeded) do
        User.find_sole_by(name: name)
      end

      User.delete_all
    end
  end
end
```

This code was generated by my cousin Vinny The GPT-4. Verified by me. Still need to learn more about PBT to revise and make it more useful for documenting Rails.
